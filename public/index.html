<!doctype html>

<html>
	<head>
		<meta charset="utf-8">
		<title>Deploy bowdoinorient.com</title>
		<link rel="stylesheet" href="style.css">
	</head>
	<body>
		<main id="app">
		    <section>
			<h1>Bowdoin Orient Deployment Dashboard</h1>
		    </section>

		    <section>
                <button class="btn" @click="update_master">Update master</button>
                <button class="btn" @click="deploy_master">Deploy master</button>
                <p>Last deployed {{ last_deploy_timestamp | reldate}}</p>
		    </section>

		    <section>
                <button class="btn" @click="devenv_form_visible = !devenv_form_visible">New Dev Environment</button>
                <p v-if="devenv_form_visible">
                    <input v-model="new_devenv_subdomain" placeholder="subdomain"><code>.test.bowdoinorient.co</code><br>
                    <button @click="new_devenv_confirm" v-bind:disabled="new_devenv_subdomain.match(/[^a-z0-9_]/)">Confirm</button>
                </p>

                <p v-if="new_devenv_subdomain.match(/[^a-z0-9_]/)" class="warning-text">You can only have lower case letters, numbers, and underscores in the subdomain.</p>

               <ul class="envs">
                    <li v-for="env in devenvs">
                    <span v-bind:class="'env ' + env.subdomain"></span>
                    <a v-bind:href="href_prefix + env.subdomain + href_postfix"
                       >{{env.subdomain}}</a>
                    â€” {{ env.more_text }}
                    Last updated {{env.last_updated | reldate}}.
                    <span v-if="env.subdomain != 'master'">
                        <a href="#" @click="info_env(env.subdomain)">info</a> |
                        <a href="#" class="delete" @click="delete_env(env.subdomain)">delete</a>
                    </span>
                    </li>
                </ul>
            </section>

            <section v-if="new_devenv">
                <p><strong>scp code:</strong></p>
                <pre><code>$ {{ scp_code }}</code></pre>
                <p><strong>rsync code:</strong></p>
                <pre><code>$ {{ rsync_code }}</code></pre>
                <p><strong>MySQL info:</strong></p>
                <p>Username: <code>{{ mysql_username }}</code><br>Password: <code>{{ mysql_password }}</code></p>
            </section>
		</main>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.5.17/vue.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>
		<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
		<script src="script.js"></script>
	</body>
</html>
